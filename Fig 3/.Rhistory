rect(xx[1], m3, xx[l0 + 1], w[1], col = grey(1))
for (i in 1:l0) rect(xx[i], m3, xx[i + 1], w[i], col = col[i])
library(ade4)
data(friday87)
w1 <- data.frame(scale(friday87$fau, scal = FALSE))
w2 <- ktab.data.frame(w1, friday87$fau.blo, tabnames = friday87$tab.names)
mcoa1 <- mcoa(w2, "lambda1", scan = FALSE)
mcoa1
plot(mcoa1)
nf <- mcoa1$nf
eig.bottom = TRUE
opar <- par(mar = par("mar"))
on.exit(par(opar))
born <- par("usr")
w <- mcoa1$pseudoeig
col <- rep(grey(1), length(w))
col[1:nf] <- grey(0.8)
col[c(1:2)] <- grey(0)
l0 <- length(w)
xx <- seq(born[1], born[1] + (born[2] - born[1]) * l0/60,
le = l0 + 1)
w <- w/max(w)
w <- w * (born[4] - born[3])/4
par(mar = c(0.2, 0.2, 0.1, 0.1))
m3 <- born[3]
w <- m3 + w
rect(xx[1], m3, xx[l0 + 1], w[1], col = grey(1))
for (i in 1:l0) rect(xx[i], m3, xx[i + 1], w[i], col = col[i])
library(ade4)
data(friday87)
w1 <- data.frame(scale(friday87$fau, scal = FALSE))
w2 <- ktab.data.frame(w1, friday87$fau.blo, tabnames = friday87$tab.names)
mcoa1 <- mcoa(w2, "lambda1", scan = FALSE)
mcoa1
plot(mcoa1)
nf <- mcoa1$nf
eig.bottom = TRUE
opar <- par(mar = par("mar"))
on.exit(par(opar))
born <- par("usr")
w <- mcoa1$pseudoeig
col <- rep(grey(1), length(w))
col[1:nf] <- grey(0.8)
col[c(1:2)] <- grey(0)
l0 <- length(w)
xx <- seq(born[1], born[1] + (born[2] - born[1]) * l0/60,
le = l0 + 1)
w <- w/max(w)
w <- w * (born[4] - born[3])/4
par(mar = c(0.8, 0.8, 0.1, 0.1))
m3 <- born[3]
w <- m3 + w
rect(xx[1], m3, xx[l0 + 1], w[1], col = grey(1))
for (i in 1:l0) rect(xx[i], m3, xx[i + 1], w[i], col = col[i])
library(ade4)
data(friday87)
w1 <- data.frame(scale(friday87$fau, scal = FALSE))
w2 <- ktab.data.frame(w1, friday87$fau.blo, tabnames = friday87$tab.names)
mcoa1 <- mcoa(w2, "lambda1", scan = FALSE)
mcoa1
plot(mcoa1)
nf <- mcoa1$nf
eig.bottom = TRUE
opar <- par(mar = par("mar"))
on.exit(par(opar))
born <- par("usr")
w <- mcoa1$pseudoeig
col <- rep(grey(1), length(w))
col[1:nf] <- grey(0.8)
col[c(1:2)] <- grey(0)
l0 <- length(w)
xx <- seq(born[1], born[1] + (born[2] - born[1]) * l0/60,
le = l0 + 1)
w <- w/max(w)
w <- w * (born[4] - born[3])/4
par(mar = c(0.8, 0.8, 0.8, 0.8))
m3 <- born[3]
w <- m3 + w
rect(xx[1], m3, xx[l0 + 1], w[1], col = grey(1))
for (i in 1:l0) rect(xx[i], m3, xx[i + 1], w[i], col = col[i])
{if (eig.bottom)
m3 <- born[3]
else m3 <- born[4] - w[1]
}
library(ade4)
data(friday87)
w1 <- data.frame(scale(friday87$fau, scal = FALSE))
w2 <- ktab.data.frame(w1, friday87$fau.blo, tabnames = friday87$tab.names)
mcoa1 <- mcoa(w2, "lambda1", scan = FALSE)
mcoa1
plot(mcoa1)
nf <- mcoa1$nf
eig.bottom = TRUE
opar <- par(mar = par("mar"))
on.exit(par(opar))
born <- par("usr")
w <- mcoa1$pseudoeig
col <- rep(grey(1), length(w))
col[1:nf] <- grey(0.8)
col[c(1:2)] <- grey(0)
l0 <- length(w)
xx <- seq(born[1], born[1] + (born[2] - born[1]) * l0/60,
le = l0 + 1)
w <- w/max(w)
w <- w * (born[4] - born[3])/4
par(mar = c(0.8, 0.8, 0.8, 0.8))
{if (eig.bottom)
m3 <- born[3]
else m3 <- born[4] - w[1]
}
w <- m3 + w
rect(xx[1], m3, xx[l0 + 1], w[1], col = grey(1))
for (i in 1:l0) rect(xx[i], m3, xx[i + 1], w[i], col = col[i])
born[3]
w
xx
library(ade4)
data(friday87)
w1 <- data.frame(scale(friday87$fau, scal = FALSE))
w2 <- ktab.data.frame(w1, friday87$fau.blo, tabnames = friday87$tab.names)
mcoa1 <- mcoa(w2, "lambda1", scan = FALSE)
mcoa1
plot(mcoa1)
nf <- mcoa1$nf
eig.bottom = TRUE
opar <- par(mar = par("mar"))
on.exit(par(opar))
born <- par("usr")
w <- mcoa1$pseudoeig
col <- rep(grey(1), length(w))
col[1:nf] <- grey(0.8)
col[c(1:2)] <- grey(0)
l0 <- length(w)
xx <- seq(born[1], born[1] + (born[2] - born[1]) * l0/60,
le = l0 + 1)
w <- w/max(w)
w <- w * (born[4] - born[3])/4
par(mar = c(0.8, 0.8, 0.8, 0.8))
{if (eig.bottom)
m3 <- born[3]
else m3 <- born[4] - w[1]
}
w <- m3 + w
rect(xx[1], m3, xx[l0 + 1], w[1], col = grey(1))
for (i in 1:l0) rect(xx[i], m3, xx[i + 1], w[i], col = col[i])
W
W
w
library(ade4)
data(friday87)
w1 <- data.frame(scale(friday87$fau, scal = FALSE))
w2 <- ktab.data.frame(w1, friday87$fau.blo, tabnames = friday87$tab.names)
mcoa1 <- mcoa(w2, "lambda1", scan = FALSE)
mcoa1
plot(mcoa1)
nf <- mcoa1$nf
eig.bottom = TRUE
opar <- par(mar = par("mar"))
on.exit(par(opar))
born <- par("usr")
w <- mcoa1$pseudoeig
col <- rep(grey(1), length(w))
col[1:nf] <- grey(0.8)
col[c(1:2)] <- grey(0)
l0 <- length(w)
xx <- seq(born[1], born[1] + (born[2] - born[1]) * l0/60,
le = l0 + 1)
w <- w/max(w)
w <- w * (born[4] - born[3])/4
par(mar = c(0.8, 0.8, 0.8, 0.8))
{if (eig.bottom)
m3 <- born[3]
else m3 <- born[4] - w[1]
}
w <- m3 + w
rect(xx[1], m3, xx[l0 + 1], w[1], col = grey(1))
for (i in 1:l0) rect(xx[i], m3, xx[i + 1], w[i], col = col[i])
library(ade4)
data(friday87)
w1 <- data.frame(scale(friday87$fau, scal = FALSE))
w2 <- ktab.data.frame(w1, friday87$fau.blo, tabnames = friday87$tab.names)
mcoa1 <- mcoa(w2, "lambda1", scan = FALSE)
mcoa1
plot(mcoa1)
nf <- mcoa1$nf
eig.bottom = TRUE
opar <- par(mar = par("mar"))
on.exit(par(opar))
born <- par("usr")
w <- mcoa1$pseudoeig
col <- rep(grey(1), length(w))
col[1:nf] <- grey(0.8)
col[c(1:2)] <- grey(0)
l0 <- length(w)
xx <- seq(born[1], born[1] + (born[2] - born[1]) * l0/60,
le = l0 + 1)
w <- w/max(w)
w <- w * (born[4] - born[3])/4
par(mar = c(0.8, 0.8, 0.8, 0.8))
{if (eig.bottom)
m3 <- born[3]
else m3 <- born[4] - w[1]
}
w <- m3 + w
rect(xx[1], m3, xx[l0 + 1], w[1], col = grey(1))
for (i in 1:l0) rect(xx[i], m3, xx[i + 1], w[i], col = col[i])
rect(xx[1], m3, xx[1 + 1], w[1], col = col[1])
View(opar)
xx
a <- rect(xx[1], m3, xx[1 + 1], w[1], col = col[1])
pcoa_eig <- (mcoa1$pseudoeig)[1:2] / sum(mcoa1$pseudoeig)
pcoa_eig
pcoa_eig <- (mcoa1$pseudoeig)[1:20] / sum(mcoa1$pseudoeig)
pcoa_eig
barplot(pcoa_eig)
pcoa_eig <- (mcoa1$pseudoeig)[1:16] / sum(mcoa1$pseudoeig)
barplot(pcoa_eig)
library(ade4)
data(friday87)
w1 <- data.frame(scale(friday87$fau, scal = FALSE))
w2 <- ktab.data.frame(w1, friday87$fau.blo, tabnames = friday87$tab.names)
mcoa1 <- mcoa(w2, "lambda1", scan = FALSE)
mcoa1
plot(mcoa1)
library(wesanderson)
library(RColorBrewer)
library(ggsci)
library(vegan)
library(ggtext)
library(hrbrthemes)
library(ggplot2)
library(pheatmap)
library(vegan)
library(colorRamps)
library(dplyr)
setwd("E:/陈沛霖-病原菌/宏转录/MS/code/Fig 3")
gene <- read.csv("trade.csv",header = T)
gene <- data.frame(t(gene))
drought <- read.csv("Drought_Group_1.csv",header = T,row.names = 1)
drought <- filter(drought, !drought$Drought=="#N/A")
gene_d <- as.data.frame(gene[row.names(gene)%in%row.names(drought),])
gene_c <- rbind(gene[c(1,2),],gene_d)
data <- data.frame(t(gene_c))
data[,-c(1,2)]<-as.numeric(unlist(data[,-c(1,2)]))
data <- data[ rowSums(data[,-c(1,2)])!=0, ]
data[,-c(1,2)]<-decostand(data[,-c(1,2)], 'standardize',1)
data1 <- data.frame(aggregate(data[,-c(1,2)],by=list(data$Group) , sum))
rownames(data1)<-data1$Group.1
data1 <- data1[,-1]
data1<-data.frame(t(data1))
row.names(drought)==row.names(data1)
data1 <- cbind(drought,data1)
data1$Week <- gsub("TP","",as.character(data1$Week))
data1$Week <- as.numeric(data1$Week)
data1$group_week <- data1$Week
data1$ID <- rownames(data1)
gene_diversity <- read.csv("gene_diversty.csv",header = T)
data2 <- left_join(data1,gene_diversity,by='ID')
nri_alpha <- read.csv("OTU_nri_alpha.csv",header = T,row.names=1)
colnames(nri_alpha)[4] <-c('otu_diversity')
colnames(nri_alpha)[25] <-c('NRI')
nri_alpha$ID <- rownames(nri_alpha)
nri_alpha$ID <- gsub("_quant","",as.character(nri_alpha$ID))
nri_alpha$ID <- gsub("_unmaped","",as.character(nri_alpha$ID))
data3 <- left_join(data2,nri_alpha,by='ID')
colnames(data3)[34] <-c('gene_diversity')
data3 <-na.omit(data3)
data3[,c(34,40,61)]<-decostand(data3[,c(34,40,61)], 'standardize',2)
data3$Drought <- as.numeric(data3$Drought)
data3$Sorg_protein_degrade
library(lavaan)
library(semPlot)
model<-'
SWEET1~Week
STR2b~Week+Drought+RAM2
PDR1~Drought
RAM2~Drought+FaTM
FaTM~Drought
otu_diversity~SWEET1+STR2b+Drought+PDR1
gene_diversity~otu_diversity+Week+Drought+SWEET1+FaTM
'
fit<-sem(model = model,data = data3,sample.nobs = 60)
semPaths(fit,'std',layout = "tree2",sizeMan = 10,sizeLat = 10)
fitMeasures(fit,c("chisq","df","pvalue","gfi","cfi","rmr","srmr","rmsea"))
summary(fit)
summary(fitstandardized = T, rsq = T)
summary(fit,standardized = T, rsq = T)
model<-'
SWEET1~Week+Drought
STR2b~Week+Drought+RAM2
PDR1~Drought
RAM2~Drought+FaTM
FaTM~Drought+Week
otu_diversity~SWEET1+STR2b+Drought+PDR1
gene_diversity~otu_diversity+Week+Drought+SWEET1+RAM2+FaTM
'
fit<-sem(model = model,data = data3,sample.nobs = 60)
semPaths(fit,'std',layout = "tree2",sizeMan = 10,sizeLat = 10)
fitMeasures(fit,c("chisq","df","pvalue","gfi","cfi","rmr","srmr","rmsea"))
View(data3)
model<-'
SWEET1~Week+Drought
STR2b~Week+Drought+RAM2
PDR1~Drought
RAM2~Drought+FaTM
FaTM~Drought+Week
NRI~SWEET1+STR2b+Drought+PDR1
gene_diversity~NRI+Week+Drought+SWEET1+RAM2+FaTM
'
fit<-sem(model = model,data = data3,sample.nobs = 60)
semPaths(fit,'std',layout = "tree2",sizeMan = 10,sizeLat = 10)
fitMeasures(fit,c("chisq","df","pvalue","gfi","cfi","rmr","srmr","rmsea"))
summary(fit,standardized = T, rsq = T)
model<-'
SWEET1~Week+Drought
STR2b~Week+Drought+RAM2
PDR1~Drought
RAM2~Drought+FaTM
FaTM~Drought+Week
NRI~SWEET1+STR2b+Drought+PDR1+Week
gene_diversity~NRI+Week+Drought+SWEET1+RAM2+FaTM
'
fit<-sem(model = model,data = data3,sample.nobs = 60)
semPaths(fit,'std',layout = "tree2",sizeMan = 10,sizeLat = 10)
fitMeasures(fit,c("chisq","df","pvalue","gfi","cfi","rmr","srmr","rmsea"))
model<-'
SWEET1~Week+Drought
STR2b~Week+Drought+RAM2
PDR1~Drought
RAM2~Drought+FaTM
FaTM~Drought+Week
NRI~SWEET1+STR2b+Drought+PDR1+Week+FaTM
gene_diversity~NRI+Week+Drought+SWEET1+RAM2+FaTM
'
fit<-sem(model = model,data = data3,sample.nobs = 60)
semPaths(fit,'std',layout = "tree2",sizeMan = 10,sizeLat = 10)
fitMeasures(fit,c("chisq","df","pvalue","gfi","cfi","rmr","srmr","rmsea"))
summary(fit,standardized = T, rsq = T)
model<-'
SWEET1~Week
STR2b~Week+Drought+RAM2
PDR1~Drought
RAM2~Drought+FaTM
FaTM~Drought+Week
NRI~SWEET1+STR2b+Week+FaTM
gene_diversity~NRI+Week+Drought+SWEET1+RAM2+FaTM
'
fit<-sem(model = model,data = data3,sample.nobs = 60)
semPaths(fit,'std',layout = "tree2",sizeMan = 10,sizeLat = 10)
fitMeasures(fit,c("chisq","df","pvalue","gfi","cfi","rmr","srmr","rmsea"))
summary(fit,standardized = T, rsq = T)
model<-'
SWEET1~Week
STR2b~Week+Drought+RAM2
PDR1~Drought+Week
RAM2~Drought+FaTM
FaTM~Drought+Week
NRI~SWEET1+STR2b+Week+FaTM
gene_diversity~NRI+Week+Drought+SWEET1+RAM2+FaTM
'
fit<-sem(model = model,data = data3,sample.nobs = 60)
semPaths(fit,'std',layout = "tree2",sizeMan = 10,sizeLat = 10)
fitMeasures(fit,c("chisq","df","pvalue","gfi","cfi","rmr","srmr","rmsea"))
summary(fit,standardized = T, rsq = T)
model<-'
SWEET1~Week
STR2b~Week+Drought+RAM2
PDR1~Drought
RAM2~Drought+FaTM
FaTM~Drought+Week
NRI~SWEET1+STR2b+Week+FaTM
gene_diversity~NRI+Week+Drought+SWEET1+FaTM
'
fit<-sem(model = model,data = data3,sample.nobs = 60)
semPaths(fit,'std',layout = "tree2",sizeMan = 10,sizeLat = 10)
fitMeasures(fit,c("chisq","df","pvalue","gfi","cfi","rmr","srmr","rmsea"))
summary(fit,standardized = T, rsq = T)
model<-'
SWEET1~Week
STR2b~Week+Drought+RAM2
PDR1~Drought
RAM2~Drought+FaTM
FaTM~Drought
NRI~SWEET1+STR2b+Week+FaTM
gene_diversity~NRI+Week+Drought+SWEET1+FaTM
'
fit<-sem(model = model,data = data3,sample.nobs = 60)
semPaths(fit,'std',layout = "tree2",sizeMan = 10,sizeLat = 10)
fitMeasures(fit,c("chisq","df","pvalue","gfi","cfi","rmr","srmr","rmsea"))
summary(fit,standardized = T, rsq = T)
model<-'
SWEET1~Week
STR2b~Week+Drought+RAM2
PDR1~Drought
RAM2~Drought+FaTM
FaTM~Drought
otu_diversity~SWEET1+STR2b+Drought+PDR1
gene_diversity~otu_diversity+Week+Drought+SWEET1+FaTM
'
model<-'
SWEET1~Week+Drought
STR2b~Week+Drought+RAM2
PDR1~Drought
RAM2~Drought+FaTM
FaTM~Drought+Week
otu_diversity~SWEET1+STR2b+Drought+PDR1
gene_diversity~otu_diversity+Week+Drought+SWEET1+RAM2+FaTM
'
fit<-sem(model = model,data = data3,sample.nobs = 60)
semPaths(fit,'std',layout = "tree2",sizeMan = 10,sizeLat = 10)
fitMeasures(fit,c("chisq","df","pvalue","gfi","cfi","rmr","srmr","rmsea"))
summary(fit, standardized = TRUE, fit.measures = TRUE, rsquare = TRUE)
model<-'
SWEET1~Week+Drought
STR2b~Week+Drought+RAM2
PDR1~Drought
RAM2~Drought+FaTM
FaTM~Drought+Week
otu_diversity~SWEET1+STR2b+Drought+PDR1
gene_diversity~otu_diversity+Week+Drought+SWEET1+FaTM
'
fit<-sem(model = model,data = data3,sample.nobs = 60)
semPaths(fit,'std',layout = "tree2",sizeMan = 10,sizeLat = 10)
fitMeasures(fit,c("chisq","df","pvalue","gfi","cfi","rmr","srmr","rmsea"))
summary(fit, standardized = TRUE, fit.measures = TRUE, rsquare = TRUE)
library(wesanderson)
library(RColorBrewer)
library(ggsci)
library(vegan)
library(ggtext)
library(hrbrthemes)
library(ggplot2)
library(pheatmap)
library(vegan)
library(colorRamps)
library(dplyr)
setwd("E:/陈沛霖-病原菌/宏转录/MS/code/Fig 3")
gene <- read.csv("trade.csv",header = T)
gene <- data.frame(t(gene))
drought <- read.csv("Drought_Group_1.csv",header = T,row.names = 1)
drought <- filter(drought, !drought$Drought=="#N/A")
gene_d <- as.data.frame(gene[row.names(gene)%in%row.names(drought),])
gene_c <- rbind(gene[c(1,2),],gene_d)
data <- data.frame(t(gene_c))
data[,-c(1,2)]<-as.numeric(unlist(data[,-c(1,2)]))
data <- data[ rowSums(data[,-c(1,2)])!=0, ]
data[,-c(1,2)]<-decostand(data[,-c(1,2)], 'standardize',1)
data1 <- data.frame(aggregate(data[,-c(1,2)],by=list(data$Group) , sum))
rownames(data1)<-data1$Group.1
data1 <- data1[,-1]
data1<-data.frame(t(data1))
row.names(drought)==row.names(data1)
data1 <- cbind(drought,data1)
data1$Week <- gsub("TP","",as.character(data1$Week))
data1$Week <- as.numeric(data1$Week)
data1$group_week <- data1$Week
data1$ID <- rownames(data1)
gene_diversity <- read.csv("gene_diversty.csv",header = T)
data2 <- left_join(data1,gene_diversity,by='ID')
nri_alpha <- read.csv("OTU_nri_alpha.csv",header = T,row.names=1)
colnames(nri_alpha)[4] <-c('otu_diversity')
colnames(nri_alpha)[25] <-c('NRI')
nri_alpha$ID <- rownames(nri_alpha)
nri_alpha$ID <- gsub("_quant","",as.character(nri_alpha$ID))
nri_alpha$ID <- gsub("_unmaped","",as.character(nri_alpha$ID))
data3 <- left_join(data2,nri_alpha,by='ID')
colnames(data3)[34] <-c('gene_diversity')
data3 <-na.omit(data3)
data3[,c(34,40,61)]<-decostand(data3[,c(34,40,61)], 'standardize',2)
data3$Drought <- as.numeric(data3$Drought)
data3$Sorg_protein_degrade
library(lavaan)
library(semPlot)
model<-'
SWEET1~Week+Drought
STR2b~Week+Drought+RAM2
PDR1~Drought
RAM2~Drought+FaTM
FaTM~Drought+Week
otu_diversity~SWEET1+STR2b+Drought+PDR1
gene_diversity~otu_diversity+Week+Drought+SWEET1+FaTM
'
fit<-sem(model = model,data = data3,sample.nobs = 60)
semPaths(fit,'std',layout = "tree2",sizeMan = 10,sizeLat = 10)
fitMeasures(fit,c("chisq","df","pvalue","gfi","cfi","rmr","srmr","rmsea"))
summary(fit, standardized = TRUE, fit.measures = TRUE, rsquare = TRUE)
model<-'
SWEET1~Week+Drought
STR2b~Week+Drought+RAM2
PDR1~Drought
RAM2~Drought+FaTM
FaTM~Drought+Week
otu_diversity~SWEET1+STR2b+PDR1
gene_diversity~otu_diversity+Week+Drought+SWEET1+FaTM
'
fit<-sem(model = model,data = data3,sample.nobs = 60)
semPaths(fit,'std',layout = "tree2",sizeMan = 10,sizeLat = 10)
fitMeasures(fit,c("chisq","df","pvalue","gfi","cfi","rmr","srmr","rmsea"))
summary(fit, standardized = TRUE, fit.measures = TRUE, rsquare = TRUE)
model<-'
SWEET1~Week+Drought
STR2b~Week+Drought+RAM2
PDR1~Drought
RAM2~Drought+FaTM
FaTM~Drought+Week
otu_diversity~SWEET1+STR2b+Drought+PDR1
gene_diversity~otu_diversity+Week+Drought+SWEET1+FaTM
'
fit<-sem(model = model,data = data3,sample.nobs = 60)
semPaths(fit,'std',layout = "tree2",sizeMan = 10,sizeLat = 10)
fitMeasures(fit,c("chisq","df","pvalue","gfi","cfi","rmr","srmr","rmsea"))
summary(fit, standardized = TRUE, fit.measures = TRUE, rsquare = TRUE)
